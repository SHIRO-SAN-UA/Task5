# Web Automation Framework for Winn.ai

Automation framework for [Winn.ai](https://winn.ai/).

## Reports

HTML Reporting system that is hosted in []().

## Technologies Stack

-   [Node.js](https://nodejs.org/en/)
-   [TypeScript](https://www.typescriptlang.org/)
-   [Playwright Framework](https://playwright.dev/) - testing framework for modern web apps.
-   [Axios Library](https://axios-http.com/) - promise based HTTP client. Used for Making http requests from node.js.
-   [Gmail Tester](https://github.com/levz0r/gmail-tester) - Node.js Gmail client for mail.
-   [Moment.js](https://momentjs.com/) - A JavaScript date library for parsing, validating, manipulating, and formatting dates.
-   [dotenv](https://www.npmjs.com/package/dotenv) - load environment variables from a .env file into process.env.
-   [ESlint](https://eslint.org/) - statically analyzes your code to quickly find problems.
-   [Prettier](https://prettier.io/) - code formatter.

## Setup

### Installation

1.  Run `git clone https://github.com/winn-ai/playwright-automation.git` to clone repository.
1.  Run `npm install` to install dependencies.
1.  Run `npx playwright install --with-deps chromium` to install chromium browser for playwright framework.
1.  To run locally get access to **GCP** and copy **user_qa** folder to local **environment** folder.

### How to run tests

For reference use [Playwright Docs](https://playwright.dev/docs/running-tests)

1. Go to `package.json` `test:headed` script specify relative path to test or tests using regexp. Example:
    - Relative path:
        ```bash
        npx playwright test ./tests/specs/regression/onboarding/onboarding.spec.ts --project=headed
        ```
    - Relative path with Regexp:
        ```bash
        npx playwright test ./tests/specs/regression/.*/.*.spec.ts --project=headed
        ```
1. Run npm script `npm run test:headed`

We defined a default configuration (config/wdio.conf.js) which is used for specific configurations: appium(local run), sauce(Sauce Labs cloud service). They all can be executed when you run one of scripts from `package.json` like `test:sauce:both:os` or `test:appium:android`.

## Environment variables

Env variables can be passed to **scripts** directly, or put in `.env`([dotenv](https://www.npmjs.com/package/dotenv)) file

-   `ENV` - application environment. Options: **stg**, **prod**. Default: **stg**.
-   `WORKERS_AMOUNT` - amount of parallel tests.
-   `USERS_AMOUNT` - amount of users for load test.

Example how to set env variable:
Script:

```bash
env ENV=prod WORKERS_AMOUNT=2 npx playwright test
```

Dotenv:

`.env` file content

```bash
ENV=prod
WORKERS_AMOUNT=2
```

## Framework Structure

### Structure

-   `playwright.config.ts` file is the place where you can configure the playwright library. You can configure timeouts, parallelism, retires, and reporters, projects, etc. Playwright supports tons of customization and adjustment to meet your test suiteâ€™s requirements.
-   `api` folder contain API requests that are used for automation.
    -   `controller` - controllers for specific endpoints with api requests.
    -   `methods` - methods that use requests from controllers.
-   `environment` - folder with data and variables
-   `extension` - folder with extension for prod and stg. Required to use extension during automation.
-   `hooks` - setup and teardown hooks for playwright framework.
-   `reports` - autogenerated folder that contains reports of last run
-   `scripts` folder that contain bash and ts scripts that may be used outside test run (build, preconditions)
-   `tests` folder contains
    -   `helpers` - classes with methods for different functionality.
    -   `specs` - folder with tests
    -   `pages` - forder with pages
    -   `utils` - has very short and specific functions, snippets that you can use throughout the application.
-   `fixtures` folder contain [fixtures](https://playwright.dev/docs/test-fixtures)

### Standards

All test cases should be coded inside the `tests` folder.
Project build using [Page Object Model](https://playwright.dev/docs/pom). The main idea is to encapsulate logic into page classes and use the logic in the spec files to run the tests.

For instance we defined the class LoginPage with locators and elements and reuse them in the code.
